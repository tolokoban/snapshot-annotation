"use strict";(self.webpackChunksnapshot_annotation=self.webpackChunksnapshot_annotation||[]).push([[143],{164:(n,t,e)=>{e.d(t,{Z:()=>c});var r=e(81),o=e.n(r),i=e(645),a=e.n(i)()(o());a.push([n.id,"div.App {\n    --menu-width: 300px;\n    position: absolute;\n    left: 0;\n    top: 0;\n    top: 0;\n    bottom: 0;\n    width: 100%;\n    height: 100%;\n    margin: 0;\n    padding: 0;\n}\n\ndiv.App > .body {\n    position: absolute;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    right: var(--menu-width);\n}\n\ndiv.App > menu {\n    position: absolute;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    width: var(--menu-width);\n    background-color: #0003;\n    margin: 0;\n    padding: 1em;\n}\n\ndiv.App canvas.preview {\n    background-color: #fff3;\n}",""]);const c=a},788:(n,t,e)=>{e.d(t,{Z:()=>c});var r=e(81),o=e.n(r),i=e(645),a=e.n(i)()(o());a.push([n.id,":root {\n    --background: linear-gradient(\n        200.96deg,\n        hsl(30, 99%, 58%) -5%,\n        hsl(210, 66%, 60%) 52%,\n        hsl(240, 56%, 40%) 120%\n    );\n}\n\n* {\n    box-sizing: border-box;\n}\n\nhtml, body, div#app {\n    position: absolute;\n    left: 0;\n    top: 0;\n    top: 0;\n    bottom: 0;\n    width: 100%;\n    height: 100%;\n    margin: 0;\n    padding: 0;\n}\n\nbody {\n    color: white;\n    background: var(--background);\n    font-family: sans-serif;\n    overflow-y: hidden;\n}\n\nfieldset {\n    display: inline-block;\n    border: 1px solid var(--theme-color-on-screen-opacity-50);\n    background: var(--theme-color-screen-opacity-50);\n    color: var(--theme-color-on-screen);\n    border-radius: 1em;\n}\n\nfieldset.wide {\n    display: block;\n}\n\nfieldset > legend {\n    all: unset;\n    background: transparent;\n    padding: 0;\n}\n\nfieldset > legend > div.custom {\n    margin: 0;\n}\n\nbody > div#app {\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    overflow: hidden;\n    margin: 0;\n    padding: 0;\n}\n\nheader {\n    background-color: var(--theme-color-primary-dark);\n    color: var(--theme-color-on-primary-dark);\n    padding: 0 0.5em;\n    box-shadow: var(--theme-shadow-header);\n    flex: 0 0 auto;\n    display: flex;\n    flex-direction: row;\n    justify-content: space-between;\n    align-items: center;\n    min-height: 3rem;\n}\n\nheader * {\n    margin-top: 0;\n    margin-bottom: 0;\n}\n\np {\n    font-size: 80%;\n    background-color: var(--theme-color-screen);\n    color: var(--theme-color-on-screen-opacity-50);\n    border-left: 0.5em solid var(--theme-color-accent-dark);\n    margin: 0.5em;\n    padding: 0.5em 1em;\n}\n\nbutton {\n    background: linear-gradient(\n        to left,\n        hsl(30, 99%, 38%) -5%,\n        hsl(210, 66%, 60%) 52%,\n        hsl(240, 56%, 40%) 120%\n    );\n    color: #fff;\n    border: none;\n    display: flex;\n    justify-content: space-around;\n    align-items: center;\n    font-variant: small-caps;\n    font-size: 110%;\n    height: 2em;\n    width: 100%;\n    margin: .5em 0;\n    cursor: pointer;\n    box-shadow: 0 4px 8px #000;\n    transition: all .2s;\n}\n\nbutton:hover {\n    box-shadow: 0 6px 12px #000;\n    transform: translateY(-2px);\n}\n\nbutton:active {\n    box-shadow: 0 1px 2px #000;\n    transform: translateY(3px);\n}\n\nhr {\n    margin: 3em 0;\n    border: none;\n    height: 1px;\n    width: 100%;\n    background-image: linear-gradient(\n        to left,\n        transparent,\n        currentColor,\n        currentColor,\n        transparent\n    );\n}",""]);const c=a},100:(n,t,e)=>{e.d(t,{Z:()=>c});var r=e(81),o=e.n(r),i=e(645),a=e.n(i)()(o());a.push([n.id,".view-AspectRatioKeeperView {\n    display: grid;\n    place-items: center;    \n}\n",""]);const c=a},959:(n,t,e)=>{e.d(t,{Z:()=>c});var r=e(81),o=e.n(r),i=e(645),a=e.n(i)()(o());a.push([n.id,".view-InputView {\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-start;\n    align-items: stretch;\n}\n\n.view-InputView > label {\n    font-size: 80%;\n    opacity: .5;\n}\n\n.view-InputView > input {\n    box-shadow: 0 2px 4ps #000;\n    border: 0;\n    background-color: #fffe;\n    color: #000e;\n    line-height: 2;\n    padding: 0 .5em;\n} ",""]);const c=a},749:(n,t,e)=>{var r=e(893),o=e(294),i=e(379),a=e.n(i),c=e(795),s=e.n(c),l=e(569),u=e.n(l),h=e(565),f=e.n(h),p=e(216),d=e.n(p),v=e(589),b=e.n(v),g=e(100),m={};m.styleTagTransform=b(),m.setAttributes=f(),m.insert=u().bind(null,"head"),m.domAPI=s(),m.insertStyleElement=d(),a()(g.Z,m),g.Z&&g.Z.locals&&g.Z.locals;var y=function(){return y=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n},y.apply(this,arguments)};function w(n){var t=o.useRef(null);return o.useEffect((function(){var e=t.current;if(e){var r=function(){var t=e.childNodes[0];if(t){var r=e.getBoundingClientRect(),o=r.width,i=r.height,a=(o-n.margin)/n.originalWidth,c=(i-n.margin)/n.originalHeight,s=Math.min(a,c);t.style.width="".concat(Math.round(n.originalWidth*s),"px"),t.style.height="".concat(Math.round(n.originalHeight*s),"px"),n.onResize&&n.onResize(o,i)}},o=new ResizeObserver(r);return o.observe(e),r(),function(){return o.unobserve(e)}}}),[n.margin,n.originalWidth,n.originalHeight,n.children,t.current]),(0,r.jsx)("div",y({className:x(n),ref:t},{children:n.children}))}function x(n){var t=["custom","view-AspectRatioKeeperView"];return"string"==typeof n.className&&t.push(n.className),t.join(" ")}var k=e(959),j={};j.styleTagTransform=b(),j.setAttributes=f(),j.insert=u().bind(null,"head"),j.domAPI=s(),j.insertStyleElement=d(),a()(k.Z,j),k.Z&&k.Z.locals&&k.Z.locals;var S=function(){return S=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n},S.apply(this,arguments)};function A(n){return(0,r.jsxs)("div",S({className:E(n)},{children:[(0,r.jsx)("label",{children:n.label}),(0,r.jsx)("input",{value:n.value,onChange:function(t){n.onChange(t.target.value)}})]}))}function E(n){var t=["custom","view-InputView"];return"string"==typeof n.className&&t.push(n.className),t.join(" ")}var T=function(n,t,e,r){return new(e||(e=Promise))((function(o,i){function a(n){try{s(r.next(n))}catch(n){i(n)}}function c(n){try{s(r.throw(n))}catch(n){i(n)}}function s(n){var t;n.done?o(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(a,c)}s((r=r.apply(n,t||[])).next())}))},P=function(n,t){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(n,a)}catch(n){i=[6,n],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},Z=function(n,t){var e="function"==typeof Symbol&&n[Symbol.iterator];if(!e)return n;var r,o,i=e.call(n),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(n){o={error:n}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(o)throw o.error}}return a},O=40,R=16;const C=function(){function n(){this.points=[],this._canvas=document.createElement("canvas"),this.image=null}return Object.defineProperty(n.prototype,"canvas",{get:function(){return this._canvas},set:function(n){this._canvas=n,this.paint()},enumerable:!1,configurable:!0}),n.prototype.removeLastAnnotation=function(){this.points.pop(),this.paint()},n.prototype.paste=function(){return T(this,void 0,void 0,(function(){var n,t,e,r,o,i,a,c,s,l,u;return P(this,(function(h){switch(h.label){case 0:return h.trys.push([0,12,,13]),[4,I()];case 1:return h.sent(),[4,navigator.clipboard.read()];case 2:n=h.sent(),h.label=3;case 3:h.trys.push([3,9,10,11]),t=function(n){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),e=t.next(),h.label=4;case 4:return e.done?[3,8]:(r=e.value).types.includes("image/png")?[4,r.getType("image/png")]:[3,7];case 5:return o=h.sent(),i=URL.createObjectURL(o),a=this,[4,N(i)];case 6:a.image=h.sent(),URL.revokeObjectURL(i),this.points=[],this.paint(),h.label=7;case 7:return e=t.next(),[3,4];case 8:return[3,11];case 9:return c=h.sent(),l={error:c},[3,11];case 10:try{e&&!e.done&&(u=t.return)&&u.call(t)}finally{if(l)throw l.error}return[7];case 11:return[3,13];case 12:return s=h.sent(),console.error(s),[3,13];case 13:return[2]}}))}))},n.prototype.addPoint=function(n,t){var e=this.canvas,r=n*e.width;if(!(r<O||r>e.width-O)){var o=t*e.height;o<O||o>e.height-O||(this.points.push({x:r,y:o,index:this.points.length+1}),this.paint())}},n.prototype.paint=function(){var n=this,t=this.canvas,e=this.image;if(t&&e){t.width=e.width+80,t.height=e.height+80,t.style.width="".concat(t.width,"px"),t.style.height="".concat(t.height,"px");var r=t.getContext("2d");if(r){r.clearRect(0,0,t.width,t.height),r.drawImage(e,O,O);var o={left:[],top:[],right:[],bottom:[]};this.points.forEach((function(n,e){var r=n.x,i=n.y,a=r,c=i,s=t.width-r,l=t.height-i,u=[[a,o.left],[c,o.top],[s,o.right],[l,o.bottom]];u.sort((function(n,t){return Z(n,1)[0]-Z(t,1)[0]}));var h=Z(u,1)[0],f=Z(h,2);f[0],f[1].push(n)})),o.left.sort((function(n,t){return n.y-t.y})),o.left.forEach((function(e,o,i){var a=O+(t.height-80)*(o+1)/(i.length+1);n.paintAnnotation(r,16,a,e)})),o.right.sort((function(n,t){return n.y-t.y})),o.right.forEach((function(e,o,i){var a=t.width-R,c=O+(t.height-80)*(o+1)/(i.length+1);n.paintAnnotation(r,a,c,e)})),o.top.sort((function(n,t){return n.x-t.x})),o.top.forEach((function(e,o,i){var a=O+(t.width-80)*(o+1)/(i.length+1);n.paintAnnotation(r,a,16,e)})),o.bottom.sort((function(n,t){return n.x-t.x})),o.bottom.forEach((function(e,o,i){var a=O+(t.width-80)*(o+1)/(i.length+1),c=t.height-R;n.paintAnnotation(r,a,c,e)}))}}},n.prototype.paintAnnotation=function(n,t,e,r){n.save(),n.beginPath(),n.moveTo(t,e),n.lineTo(r.x,r.y),n.lineWidth=5,n.strokeStyle="#fff4",n.stroke(),n.beginPath(),n.moveTo(t-R,e),n.rect(t-R,e-R,32,32),n.fillStyle="#fff4",n.fill(),n.beginPath(),n.moveTo(t,e),n.lineTo(r.x,r.y),n.lineWidth=2,n.strokeStyle="#000",n.stroke(),n.beginPath(),n.moveTo(t-R,e),n.rect(t-R+2,e-R+2,28,28),n.fillStyle="#000",n.fill(),n.font="bold ".concat(19.2,"px sans-serif"),n.fillStyle="#fff";var o="".concat(r.index);n.fillText(o,t-n.measureText(o).width/2,e+9.6),n.restore()},n}();function N(n){return T(this,void 0,void 0,(function(){return P(this,(function(t){return[2,new Promise((function(t,e){var r=new Image;r.src=n,r.onload=function(){return t(r)},r.onerror=e}))]}))}))}function I(){return T(this,void 0,void 0,(function(){var n;return P(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,navigator.permissions.query({name:"clipboard-read"})];case 1:if("denied"===t.sent().state)throw new Error("Not allowed to read clipboard.");return[3,3];case 2:return n=t.sent(),console.error(n),[3,3];case 3:return[2]}}))}))}function L(n,t){return new Promise((function(e){n.toBlob((function(n){n&&function(n,t,e){void 0===e&&(e=6e4);var r=n instanceof Blob,o=r?URL.createObjectURL(n):n,i=document.createElement("a");i.href=o,i.download=t;var a=new MouseEvent("click");requestAnimationFrame((function(){i.dispatchEvent(a)})),r&&setTimeout((function(){URL.revokeObjectURL(o)}),e)}(n,t,1e4),e()}),function(n){var t=function(n){var t=n.lastIndexOf(".");return-1===t?n:n.substring(t+1)}(n);switch(t.toLocaleLowerCase()){case"webp":return"image/webp";case"png":return"image/png";case"jpg":case"jpeg":return"image/jpeg";default:throw Error('Unsupported extension "'.concat(t,'"!'))}}(t))}))}var U=e(164),z={};z.styleTagTransform=b(),z.setAttributes=f(),z.insert=u().bind(null,"head"),z.domAPI=s(),z.insertStyleElement=d(),a()(U.Z,z),U.Z&&U.Z.locals&&U.Z.locals;var V=function(){return V=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n},V.apply(this,arguments)},W=new C;function B(n){var t=this,e=o.useRef(W),i=function(n,t){var e="function"==typeof Symbol&&n[Symbol.iterator];if(!e)return n;var r,o,i=e.call(n),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(n){o={error:n}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(o)throw o.error}}return a}(o.useState("snapshot"),2),a=i[0],c=i[1];return(0,r.jsxs)("div",V({className:_(n)},{children:[(0,r.jsx)(w,V({className:"body",margin:32,originalWidth:e.current.canvas.width,originalHeight:e.current.canvas.height},{children:(0,r.jsx)("canvas",{className:"preview",ref:function(n){n&&(e.current.canvas=n)},onDoubleClick:function(n){var t=n.target;if(t){var r=t.getBoundingClientRect(),o=(n.clientX-r.left)/r.width,i=(n.clientY-r.top)/r.height;e.current.addPoint(o,i)}}})})),(0,r.jsxs)("menu",{children:[(0,r.jsx)("button",V({onClick:function(){return e.current.paste()}},{children:"Paste from clipboard"})),(0,r.jsx)("hr",{}),(0,r.jsxs)("div",V({className:"filename"},{children:[(0,r.jsx)(A,{value:a,onChange:c,label:"Filename"}),(0,r.jsx)("button",V({onClick:function(){return n=t,r=void 0,i=function(){return function(n,t){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(n,a)}catch(n){i=[6,n],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}(this,(function(n){switch(n.label){case 0:return[4,L(e.current.canvas,"".concat(a,".webp"))];case 1:return n.sent(),[4,L(e.current.canvas,"".concat(a,".png"))];case 2:return n.sent(),[2]}}))},new((o=void 0)||(o=Promise))((function(t,e){function a(n){try{s(i.next(n))}catch(n){e(n)}}function c(n){try{s(i.throw(n))}catch(n){e(n)}}function s(n){var e;n.done?t(n.value):(e=n.value,e instanceof o?e:new o((function(n){n(e)}))).then(a,c)}s((i=i.apply(n,r||[])).next())}));var n,r,o,i}},{children:"Save"}))]})),(0,r.jsx)("hr",{}),(0,r.jsx)("button",V({onClick:function(){e.current.removeLastAnnotation()}},{children:"Remove last annotation"}))]})]}))}function _(n){var t=["custom","App"];return"string"==typeof n.className&&t.push(n.className),t.join(" ")}var H=e(745),M=e(788),G={};G.styleTagTransform=b(),G.setAttributes=f(),G.insert=u().bind(null,"head"),G.domAPI=s(),G.insertStyleElement=d(),a()(M.Z,G),M.Z&&M.Z.locals&&M.Z.locals;!function(){var n,t,e,o;n=this,t=void 0,o=function(){var n;return function(n,t){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(n,a)}catch(n){i=[6,n],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}(this,(function(t){if(!(n=document.getElementById("app")))throw Error('No element with id "app"!');return(0,H.s)(n).render((0,r.jsx)(B,{})),[2]}))},new((e=void 0)||(e=Promise))((function(r,i){function a(n){try{s(o.next(n))}catch(n){i(n)}}function c(n){try{s(o.throw(n))}catch(n){i(n)}}function s(n){var t;n.done?r(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(a,c)}s((o=o.apply(n,t||[])).next())}))}()}},n=>{n.O(0,[977],(()=>(749,n(n.s=749)))),n.O()}]);